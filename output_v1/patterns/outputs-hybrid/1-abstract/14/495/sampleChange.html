<link rel="stylesheet" href="../../../../default.css">
<script src="../../../../highlight.pack.js"></script> 
<script>hljs.initHighlightingOnLoad();</script>
<html><h3>53bcea501aab53f77cf6f313f5794b8f3e9cbca8,guava/src/com/google/common/collect/CustomConcurrentHashMap.java,Segment,replace,#K#number#V#,2502
</h3><h3>Before Change</h3><pre><code class='java'>
              && map.keyEquivalence.equivalent(key, entryKey)) {
            // If the value disappeared, this entry is partially collected,
            // and we should pretend like it doesn't exist.
            V entryValue = e.<a id="change">getValueReference()</a>.<a id="change">get()</a>;
            if (entryValue == null) {
              <a id="change">unsetLiveEntry(e</a>, <a id="change">hash</a><a id="change">)</a>;
              return null;
            }
</code></pre><h3>After Change</h3><pre><code class='java'>
      }
    }

    V replace(K key, int <a id="change">hash</a>, V newValue) {
      checkNotNull(newValue);
      lock();
      try {
        preWriteCleanup();

        // getFirst, but remember the index
        AtomicReferenceArray&lt;ReferenceEntry&lt;K, V&gt;&gt; table = this.table;
        int index = hash & (table.length() - 1);
        ReferenceEntry&lt;K, V&gt; first = table.get(index);

        for (ReferenceEntry&lt;K, V&gt; <a id="change">e</a> = first; e != null; e = e.getNext()) {
          K entryKey = e.getKey();
          if (e.getHash() == hash && entryKey != null
              && map.keyEquivalence.equivalent(key, entryKey)) {
            // If the value disappeared, this entry is partially collected,
            // and we should pretend like it doesn't exist.
            ValueReference&lt;K, V&gt; <a id="change">valueReference</a> = e.<a id="change">getValueReference()</a>;
            V entryValue = <a id="change">valueReference</a>.<a id="change">get()</a>;
            if (entryValue == null) {
              <a id="change">removeLiveEntry(table</a>, <a id="change">index</a>, <a id="change">first</a>, <a id="change">e</a>, <a id="change">hash</a>, <a id="change">valueReference</a><a id="change">)</a>;
              return null;
            }
</code></pre>